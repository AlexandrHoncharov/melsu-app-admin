{% extends "base.html" %}

{% block content %}
<!-- Хлебные крошки -->
<nav class="flex mb-5" aria-label="Breadcrumb">
    <ol class="inline-flex items-center space-x-1 md:space-x-3">
        <li class="inline-flex items-center">
            <a href="{{ url_for('dashboard.index') }}" class="text-gray-700 hover:text-primary-900">
                <i class="fas fa-home mr-2"></i>
                Дашборд
            </a>
        </li>
        <li>
            <div class="flex items-center">
                <i class="fas fa-chevron-right text-gray-400 mx-2 text-sm"></i>
                <a href="{{ url_for('teacher.teachers_list') }}" class="text-gray-700 hover:text-primary-900">
                    Преподаватели
                </a>
            </div>
        </li>
        <li>
            <div class="flex items-center">
                <i class="fas fa-chevron-right text-gray-400 mx-2 text-sm"></i>
                <span class="text-gray-500">
                    Учетные данные
                </span>
            </div>
        </li>
    </ol>
</nav>

<!-- Заголовок страницы -->
<div class="mb-6">
    <h2 class="text-2xl font-bold text-gray-900">Учетные данные преподавателя</h2>
    <p class="mt-1 text-sm text-gray-600">{{ teacher.full_name }}</p>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Данные для входа в систему -->
    <div class="lg:col-span-2">
        <div class="bg-white shadow rounded-lg overflow-hidden">
            <div class="bg-gray-50 px-4 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Данные для входа в систему</h3>
            </div>
            <div class="p-4 md:p-6">
                <div class="bg-yellow-50 rounded-md p-4 mb-6">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                Эти данные позволяют преподавателю получить доступ к системе. Передайте их преподавателю безопасным способом.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-lg p-4 md:p-6">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Логин</label>
                            <div class="flex rounded-md shadow-sm">
                                <input type="text" id="username" value="{{ credentials.username }}" readonly class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 focus:outline-none focus:ring-primary-700 focus:border-primary-700 sm:text-sm bg-white">
                                <button onclick="copyToClipboard('username')" class="inline-flex items-center px-3 py-2 rounded-r-md border border-l-0 border-gray-300 bg-gray-50 text-gray-500 hover:text-gray-900">
                                    <i class="far fa-copy"></i>
                                </button>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <div class="flex rounded-md shadow-sm">
                                <input type="text" id="email" value="{{ credentials.email }}" readonly class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 focus:outline-none focus:ring-primary-700 focus:border-primary-700 sm:text-sm bg-white">
                                <button onclick="copyToClipboard('email')" class="inline-flex items-center px-3 py-2 rounded-r-md border border-l-0 border-gray-300 bg-gray-50 text-gray-500 hover:text-gray-900">
                                    <i class="far fa-copy"></i>
                                </button>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Пароль</label>
                            <div class="flex rounded-md shadow-sm">
                                <input type="password" id="password" value="{{ credentials.password }}" readonly class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-l-md border border-gray-300 focus:outline-none focus:ring-primary-700 focus:border-primary-700 sm:text-sm bg-white">
                                <button id="togglePassword" class="inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 bg-gray-50 text-gray-500 hover:text-gray-900">
                                    <i class="far fa-eye"></i>
                                </button>
                                <button onclick="copyToClipboard('password')" class="inline-flex items-center px-3 py-2 rounded-r-md border border-l-0 border-gray-300 bg-gray-50 text-gray-500 hover:text-gray-900">
                                    <i class="far fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Информация и действия -->
    <div class="space-y-6">
        <!-- Информация о преподавателе -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
            <div class="bg-gray-50 px-4 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Информация</h3>
            </div>
            <div class="p-4 md:p-6 space-y-3">
                <div class="flex items-start">
                    <div class="flex-shrink-0 w-24 text-sm font-medium text-gray-500">Должность:</div>
                    <div class="ml-2 text-sm text-gray-900">{{ teacher.position or 'Не указана' }}</div>
                </div>
                <div class="flex items-start">
                    <div class="flex-shrink-0 w-24 text-sm font-medium text-gray-500">Кафедра:</div>
                    <div class="ml-2 text-sm text-gray-900">{{ teacher.department.name if teacher.department else 'Не указана' }}</div>
                </div>
                <div class="flex items-start">
                    <div class="flex-shrink-0 w-24 text-sm font-medium text-gray-500">Создан:</div>
                    <div class="ml-2 text-sm text-gray-900">{{ teacher.created_at.strftime('%d.%m.%Y') }}</div>
                </div>
            </div>
        </div>

        <!-- Действия -->
        <div class="bg-white shadow rounded-lg overflow-hidden">
            <div class="bg-gray-50 px-4 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Действия</h3>
            </div>
            <div class="p-4 md:p-6 space-y-3">
                <a href="{{ url_for('teacher.edit_teacher', teacher_id=teacher.id) }}" class="inline-flex justify-center items-center w-full px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-900 hover:bg-primary-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-700">
                    <i class="fas fa-edit mr-2"></i> Редактировать преподавателя
                </a>

                <form action="{{ url_for('teacher.generate_credentials', teacher_id=teacher.id) }}" method="POST">
                    <button type="submit" onclick="return confirm('Вы уверены, что хотите создать новые учетные данные? Текущие данные будут перезаписаны!');" class="inline-flex justify-center items-center w-full px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-yellow-500 hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500">
                        <i class="fas fa-sync mr-2"></i> Сгенерировать новые данные
                    </button>
                </form>

                <a href="{{ url_for('teacher.teachers_list') }}" class="inline-flex justify-center items-center w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-700">
                    <i class="fas fa-arrow-left mr-2"></i> Вернуться к списку
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function copyToClipboard(elementId) {
        const element = document.getElementById(elementId);
        element.select();
        document.execCommand('copy');

        // Создаем и показываем уведомление
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded shadow-md z-50';
        notification.innerHTML = `
            <div class="flex items-center">
                <i class="fas fa-check-circle mr-2"></i>
                <span>Скопировано в буфер обмена</span>
            </div>
        `;
        document.body.appendChild(notification);

        // Удаляем уведомление через 2 секунды
        setTimeout(() => {
            notification.classList.add('opacity-0');
            notification.style.transition = 'opacity 0.5s ease-out';
            setTimeout(() => {
                notification.remove();
            }, 500);
        }, 2000);
    }

    // Показать/скрыть пароль
    document.getElementById('togglePassword').addEventListener('click', function() {
        const passwordInput = document.getElementById('password');
        const icon = this.querySelector('i');

        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
</script>
{% endblock %}